{"version":3,"file":"eu-loader.js.map","sources":["ng://eu-loader/lib/eu-popup-insertion.directive.ts","ng://eu-loader/lib/dialog-ref.ts","ng://eu-loader/lib/dialog-config.ts","ng://eu-loader/lib/eu-loader.component.ts","ng://eu-loader/lib/dialog-injector.ts","ng://eu-loader/lib/loader/loader.component.ts","ng://eu-loader/lib/eu-loader.service.ts","ng://eu-loader/lib/eu-loader.module.ts"],"sourcesContent":["import {Directive, ViewContainerRef} from '@angular/core';\r\n\r\n@Directive({\r\n  selector: '[euPopupInsertion]',\r\n})\r\nexport class EuPopupInsertionDirective {\r\n  constructor(public viewContainerRef: ViewContainerRef) {\r\n  }\r\n}\r\n","import {Observable, Subject} from 'rxjs';\r\n\r\nexport class DialogRef {\r\n  constructor() {\r\n  }\r\n\r\n  private readonly _afterClosed = new Subject<any>();\r\n  afterClosed: Observable<any> = this._afterClosed.asObservable();\r\n\r\n  close(result?: any) {\r\n    this._afterClosed.next(result); \r\n  }\r\n}\r\n","export class DialogConfig {\r\n  type?: string;\r\n  text?: string;\r\n  dismissOnClickOutside?= true;\r\n  spinnerColor?= '#222222dc';\r\n  textColor?= '#222222dc';\r\n}\r\n","import {\n  Component,\n  Type,\n  OnDestroy,\n  AfterViewInit,\n  OnInit,\n  ComponentRef,\n  ViewChild,\n  ComponentFactoryResolver,\n  ChangeDetectorRef\n} from '@angular/core';\nimport { Subject } from 'rxjs';\nimport { EuPopupInsertionDirective } from './eu-popup-insertion.directive';\nimport { DialogRef } from './dialog-ref';\nimport { DialogConfig } from './dialog-config';\n\n@Component({\n  selector: 'lib-eu-popup',\n  templateUrl: './eu-popup.component.html',\n  styleUrls: ['./eu-popup.component.scss']\n})\nexport class EuLoaderComponent implements OnInit, AfterViewInit, OnDestroy {\n  private readonly _onClose = new Subject<any>();\n\n  public componentRef: ComponentRef<any>;\n  public childComponentType: Type<any>;\n  public onClose = this._onClose.asObservable();\n\n  @ViewChild(EuPopupInsertionDirective, { read: false }) insertionPoint: EuPopupInsertionDirective;\n\n  constructor(\n    private componentFactoryResolver: ComponentFactoryResolver,\n    private cd: ChangeDetectorRef,\n    private dialogRef: DialogRef,\n    private dialogConfig: DialogConfig,\n  ) {\n  }\n\n  ngOnInit() {\n  }\n\n  ngAfterViewInit() {\n    this.loadChildComponent(this.childComponentType);\n    this.cd.detectChanges();\n  }\n\n  ngOnDestroy() {\n    if (this.componentRef) {\n      this.componentRef.destroy();\n    }\n  }\n\n  onOverlayClicked(evt: MouseEvent) {\n    if (this.dialogConfig.dismissOnClickOutside || this.dialogConfig.dismissOnClickOutside == undefined) {\n      this.dialogRef.close();\n    }\n  }\n\n  onDialogClicked(evt: MouseEvent) {\n    evt.stopPropagation();\n  }\n\n  loadChildComponent(componentType: Type<any>) {\n    let componentFactory = this.componentFactoryResolver.resolveComponentFactory(componentType);\n\n    let viewContainerRef = this.insertionPoint.viewContainerRef;\n    viewContainerRef.clear();\n\n    this.componentRef = viewContainerRef.createComponent(componentFactory);\n  }\n}\n","import { Injector, Type, InjectionToken, InjectFlags } from '@angular/core'\r\n\r\nexport class DialogInjector implements Injector {\r\n  constructor(\r\n    private _parentInjector: Injector,\r\n    private _additionalTokens: WeakMap<any, any>\r\n  ) {}\r\n\r\n  get<T>(\r\n    token: Type<T> | InjectionToken<T>,\r\n    notFoundValue?: T,\r\n    flags?: InjectFlags\r\n  ): T\r\n  get(token: any, notFoundValue?: any)\r\n  get(token: any, notFoundValue?: any, flags?: any) {\r\n    const value = this._additionalTokens.get(token)\r\n\r\n    if (value) return value\r\n\r\n    return this._parentInjector.get<any>(token, notFoundValue)\r\n  }\r\n}\r\n","import {\r\n  Component,\r\n  OnInit,\r\n} from '@angular/core';\r\nimport { DialogRef } from '../dialog-ref';\r\nimport { DialogConfig } from '../dialog-config';\r\n\r\n@Component({\r\n  selector: 'lib-eu-loader',\r\n  templateUrl: './loader.component.html',\r\n  styleUrls: ['./loader.component.scss']\r\n})\r\nexport class LoaderComponent implements OnInit {\r\n  constructor(public config: DialogConfig, public dialog: DialogRef) {\r\n  }\r\n\r\n  onCancel() {\r\n    this.dialog.close(false);\r\n  }\r\n\r\n  onOk() {\r\n    this.dialog.close(true);\r\n  }\r\n\r\n  ngOnInit() {\r\n  }\r\n}\r\n","import {\n  Injectable,\n  ComponentFactoryResolver,\n  ApplicationRef,\n  Injector,\n  EmbeddedViewRef,\n  ComponentRef, Type,\n} from '@angular/core';\nimport { EuLoaderComponent } from './eu-loader.component';\nimport { DialogConfig } from './dialog-config';\nimport { DialogInjector } from './dialog-injector';\nimport { DialogRef } from './dialog-ref';\nimport { LoaderComponent } from './loader/loader.component';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class EuLoaderService {\n\n  dialogComponentRef: ComponentRef<EuLoaderComponent>;\n\n  constructor(\n    private componentFactoryResolver: ComponentFactoryResolver,\n    private appRef: ApplicationRef,\n    private injector: Injector\n  ) {\n  }\n\n\n  public open(config: DialogConfig) {\n    const loaderRef = this.appendDialogComponentToBody(config);\n    this.dialogComponentRef.instance.childComponentType = LoaderComponent;\n    return loaderRef;\n  }\n\n\n  public close() {\n    this.removeLoaderComponentFromBody();\n  }\n\n  private appendDialogComponentToBody(config: DialogConfig) {\n    const map = new WeakMap();\n    map.set(DialogConfig, config);\n\n    // add the DialogRef to dependency injection\n    const dialogRef = new DialogRef();\n    map.set(DialogRef, dialogRef);\n\n    // we want to know when somebody called the close mehtod\n    const sub = dialogRef.afterClosed.subscribe(() => {\n      // close the dialog\n      this.removeLoaderComponentFromBody();\n      sub.unsubscribe();\n    });\n\n    const componentFactory = this.componentFactoryResolver.resolveComponentFactory(EuLoaderComponent);\n    const componentRef = componentFactory.create(new DialogInjector(this.injector, map));\n\n    this.appRef.attachView(componentRef.hostView);\n\n    const domElem = (componentRef.hostView as EmbeddedViewRef<any>).rootNodes[0] as HTMLElement;\n    document.body.appendChild(domElem);\n\n    this.dialogComponentRef = componentRef;\n\n    this.dialogComponentRef.instance.onClose.subscribe(() => {\n      this.removeLoaderComponentFromBody();\n    });\n\n    // return the dialogRef\n    return dialogRef;\n  }\n\n  private removeLoaderComponentFromBody() {\n    this.appRef.detachView(this.dialogComponentRef.hostView);\n    this.dialogComponentRef.destroy();\n  }\n}\n","import { NgModule } from '@angular/core';\nimport { EuLoaderComponent } from './eu-loader.component';\nimport { EuPopupInsertionDirective } from './eu-popup-insertion.directive';\nimport { LoaderComponent } from './loader/loader.component';\nimport { CommonModule } from '@angular/common';\nimport { BrowserModule } from '@angular/platform-browser';\n\n@NgModule({\n  declarations: [\n    EuLoaderComponent,\n    EuPopupInsertionDirective,\n    LoaderComponent\n  ],\n  imports: [\n    CommonModule,\n    BrowserModule\n  ],\n  exports: [\n    EuLoaderComponent,\n    EuPopupInsertionDirective,\n    LoaderComponent\n  ],\n  entryComponents: [\n    EuLoaderComponent,\n    LoaderComponent\n  ],\n})\nexport class EuLoaderModule {\n}\n"],"names":[],"mappings":"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"}
